<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1E88E5;
            --primary-dark: #1565C0;
            --success: #4CAF50;
            --success-dark: #388E3C;
            --danger: #f44336;
            --danger-dark: #d32f2f;
            --warning: #FF9800;
            --purple: #9C27B0;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 20px;
            text-align: center;
            min-height: 100vh;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); background-color: #e8f5e9; }
            100% { transform: scale(1); }
        }
        
        .home-btn {
            display: inline-block;
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            margin-bottom: 20px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(30, 136, 229, 0.3);
        }
        
        .home-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--purple));
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .game-title h1 {
            margin: 0;
            color: var(--primary-dark);
            font-size: 28px;
            background: linear-gradient(45deg, var(--primary), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .game-stats {
            display: flex;
            gap: 15px;
            background: #f8f9fa;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-item i {
            color: var(--primary);
            font-size: 20px;
        }
        
        .game-mode-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            background: #e3f2fd;
            color: var(--primary);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .mode-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 5px 15px rgba(30, 136, 229, 0.4);
        }
        
        .mode-btn:hover:not(.active) {
            background: #bbdefb;
            transform: translateY(-2px);
        }
        
        .letter-section {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            position: relative;
            overflow: hidden;
        }
        
        .letter-display {
            font-size: 120px;
            color: var(--primary-dark);
            margin: 10px 0;
            font-weight: bold;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.1);
        }
        
        .letter-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .letter-name {
            font-size: 28px;
            color: var(--primary-dark);
            font-weight: bold;
            background: white;
            padding: 10px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .letter-word {
            font-size: 24px;
            color: #666;
            background: #f8f9fa;
            padding: 10px 25px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sound-btn {
            background: var(--purple);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(156, 39, 176, 0.3);
        }
        
        .sound-btn:hover {
            background: #7b1fa2;
            transform: scale(1.1);
        }
        
        .image-section {
            margin: 10px  0;
            position: relative;
        }
        
        .image-display-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .main-image {
            width: 100%;
            max-width: 350px;
            height: 250px;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            border: 5px solid white;
            background: linear-gradient(135deg, #f5f7fa 0%, #e3f2fd 100%);
            transition: transform 0.3s;
        }
        
        .main-image:hover {
            transform: scale(1.02);
        }
        
        .image-navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .image-nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--primary);
            color: white;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .image-nav-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }
        
        .image-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #555;
            margin-top: 10px;
        }
        
        .image-counter span {
            background: #f8f9fa;
            padding: 5px 15px;
            border-radius: 20px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        
        .next-with-image {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .next-btn-image {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(30, 136, 229, 0.4);
            min-width: 200px;
            justify-content: center;
        }
        
        .next-btn-image:hover {
            background: linear-gradient(135deg, var(--primary-dark), #0d47a1);
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(30, 136, 229, 0.5);
        }
        
        .exercise-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        
        .exercise-title {
            font-size: 22px;
            color: var(--primary-dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .exercise-content {
            display: none;
        }
        
        .exercise-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .option-btn {
            padding: 20px;
            font-size: 32px;
            cursor: pointer;
            border: none;
            border-radius: 15px;
            background: white;
            color: var(--primary-dark);
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-weight: bold;
        }
        
        .option-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .option-btn.correct {
            background: var(--success) !important;
            color: white;
            animation: pulse 0.5s;
        }
        
        .option-btn.wrong {
            background: var(--danger) !important;
            color: white;
            animation: shake 0.5s;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .feedback {
            margin: 20px 0;
            padding: 20px;
            font-weight: bold;
            border-radius: 15px;
            font-size: 20px;
            animation: fadeIn 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            min-height: 70px;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .feedback.wrong {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .progress-container {
            margin: 30px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 15px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--purple));
            width: 0%;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                45deg,
                rgba(255, 255, 255, 0.15) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, 0.15) 50%,
                rgba(255, 255, 255, 0.15) 75%,
                transparent 75%,
                transparent
            );
            background-size: 20px 20px;
            animation: progressStripes 1s linear infinite;
        }
        
        @keyframes progressStripes {
            0% { background-position: 0 0; }
            100% { background-position: 20px 0; }
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-weight: bold;
            color: #666;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 15px 35px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            color: white;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 180px;
            justify-content: center;
        }
        
        .action-btn:active {
            transform: scale(0.95);
        }
        
        .next-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            box-shadow: 0 8px 20px rgba(30, 136, 229, 0.4);
        }
        
        .next-btn:hover {
            background: linear-gradient(135deg, var(--primary-dark), #0d47a1);
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(30, 136, 229, 0.5);
        }
        
        .hint-btn {
            background: linear-gradient(135deg, var(--warning), #f57c00);
            box-shadow: 0 8px 20px rgba(255, 152, 0, 0.4);
        }
        
        .hint-btn:hover {
            background: linear-gradient(135deg, #f57c00, #e65100);
            transform: translateY(-3px);
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
        }
        
        .restart-btn:hover {
            background: linear-gradient(135deg, #388E3C, #2e7d32);
            transform: translateY(-3px);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            animation: modalAppear 0.5s;
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .stars {
            font-size: 40px;
            color: gold;
            margin: 20px 0;
            text-shadow: 0 0 10px rgba(255,215,0,0.5);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            .letter-display {
                font-size: 80px;
            }
            .next-with-image {
                flex-direction: column;
            }
            .next-btn-image {
                width: 100%;
                margin-top: 15px;
            }
            .options-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .action-btn {
                min-width: 150px;
                padding: 12px 25px;
            }
            .main-image {
                max-width: 100%;
                height: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .game-stats {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
            }
            .letter-info {
                flex-direction: column;
                gap: 15px;
            }
            .game-title h1 {
                font-size: 22px;
            }
            .main-image {
                height: 180px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <a href="../../../../../teacher_dashbord/arabic_dashboard.html" class="home-btn">
            <i class="fas fa-arrow-left"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </a>
        
        <div class="container">
            <!-- Ø±Ø£Ø³ Ø§Ù„Ù„Ø¹Ø¨Ø© -->
            <div class="game-header">
                <div class="game-title">
                    <h1><i class="fas fa-book-open"></i> Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…Ø·ÙˆØ±</h1>
                    <p style="color: #666; margin: 5px 0;">ØªØ¹Ù„Ù… Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø£Ø³Ù„ÙˆØ¨ ØªÙØ§Ø¹Ù„ÙŠ Ù…Ù…ØªØ¹</p>
                </div>
                <div class="game-stats">
                    <div class="stat-item">
                        <i class="fas fa-star"></i>
                        <span>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="level">1</span></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-check-circle"></i>
                        <span>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©: <span id="correct-count">0</span></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-clock"></i>
                        <span>Ø§Ù„ÙˆÙ‚Øª: <span id="timer">00:00</span></span>
                    </div>
                </div>
            </div>
            
            <!-- Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙ…Ø±ÙŠÙ† -->
            <div class="game-mode-selector">
                <button class="mode-btn active" data-mode="recognition">
                    <i class="fas fa-eye"></i> Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±Ù
                </button>
                <button class="mode-btn" data-mode="writing">
                    <i class="fas fa-pen"></i> ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ø±Ù
                </button>
                <button class="mode-btn" data-mode="word">
                    <i class="fas fa-font"></i> Ø§Ù„Ø­Ø±Ù ÙÙŠ Ø§Ù„ÙƒÙ„Ù…Ø©
                </button>
                <button class="mode-btn" data-mode="sound">
                    <i class="fas fa-volume-up"></i> Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª
                </button>
            </div>
            
            <!-- Ù‚Ø³Ù… Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø±Ù Ù…Ø¹ Ø§Ù„ØµÙˆØ±Ø© -->
            <div class="letter-section">
                <div class="letter-display" id="current-letter">Ø£</div>
                <div class="letter-info">
                    <div class="letter-name" id="letter-name">Ø§Ù„Ø£Ù„Ù</div>
                    <div class="letter-word">
                        <span id="letter-word">Ø£Ø³Ø¯</span>
                        <button class="sound-btn" id="word-sound-btn">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Ù‚Ø³Ù… Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¹ Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ -->
                <div class="image-section">
                    <div class="image-display-container">
                        <img id="main-image" class="main-image" src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ø­Ø±Ù">
                    </div>
                    <div class="image-navigation">
                        <button class="image-nav-btn" id="prev-image-btn">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="image-nav-btn" id="next-image-btn">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                    </div>
                    <div class="image-counter">
                        <span id="image-counter">1 / 1</span>
                    </div>
                    
                    <!-- Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„ØµÙˆØ±Ø© -->
                    <div class="next-with-image">
                        <div style="flex: 1;"></div>
                        <button class="next-btn-image" id="next-letter-image">
                            <i class="fas fa-arrow-left"></i> Ø§Ù„Ø­Ø±Ù Ø§Ù„ØªØ§Ù„ÙŠ
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Ù‚Ø³Ù… Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† -->
            <div class="exercise-container">
                <div class="exercise-title">
                    <i class="fas fa-brain"></i>
                    <span id="exercise-title">Ø§Ø®ØªØ± Ø§Ù„Ø­Ø±Ù Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</span>
                </div>
                
                <!-- ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±Ù -->
                <div class="exercise-content active" id="recognition-exercise">
                    <p id="question-text">Ù…Ø§ Ù‡Ùˆ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø±ÙØŸ</p>
                    <div class="options-grid" id="options-container"></div>
                </div>
                
                <!-- ØªÙ…Ø§Ø±ÙŠÙ† ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ø±Ù -->
                <div class="exercise-content" id="writing-exercise">
                    <p>Ø§ÙƒØªØ¨ Ø§Ù„Ø­Ø±Ù ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡:</p>
                    <div style="margin: 20px 0;">
                        <canvas id="writing-canvas" width="300" height="300" 
                            style="border: 3px dashed #ddd; border-radius: 15px; background: white; cursor: crosshair;"></canvas>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button class="action-btn hint-btn" onclick="clearCanvas()">
                            <i class="fas fa-eraser"></i> Ù…Ø³Ø­
                        </button>
                        <button class="action-btn next-btn" onclick="checkWriting()">
                            <i class="fas fa-check"></i> ØªØ­Ù‚Ù‚
                        </button>
                    </div>
                </div>
                
                <!-- ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø­Ø±Ù ÙÙŠ Ø§Ù„ÙƒÙ„Ù…Ø© -->
                <div class="exercise-content" id="word-exercise">
                    <p id="word-question">Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØªÙŠ ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù <span class="letter-name" id="target-letter">Ø£</span></p>
                    <div class="options-grid" id="word-options-container"></div>
                </div>
                
                <!-- ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª -->
                <div class="exercise-content" id="sound-exercise">
                    <p>Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø© Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø­Ø±Ù Ø§Ù„ØµØ­ÙŠØ­:</p>
                    <div style="margin: 30px 0;">
                        <button class="action-btn hint-btn" style="font-size: 24px; padding: 20px 40px;" onclick="playWordSound()">
                            <i class="fas fa-volume-up"></i> ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
                        </button>
                    </div>
                    <div class="options-grid" id="sound-options-container"></div>
                </div>
            </div>
            
            <!-- Ø±Ø¯ÙˆØ¯ Ø§Ù„ÙØ¹Ù„ -->
            <div class="feedback" id="feedback"></div>
            
            <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span>Ø§Ù„Ø­Ø±Ù <span id="current-index">1</span> Ù…Ù† <span id="total-letters">28</span></span>
                    <span><span id="progress-percent">0</span>%</span>
                </div>
            </div>
            
            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
            <div class="action-buttons">
                <button class="action-btn hint-btn" id="hint-btn">
                    <i class="fas fa-lightbulb"></i> ØªÙ„Ù…ÙŠØ­
                </button>
                <button class="action-btn next-btn" id="next-letter">
                    <i class="fas fa-arrow-left"></i> Ø§Ù„Ø­Ø±Ù Ø§Ù„ØªØ§Ù„ÙŠ
                </button>
                <button class="action-btn restart-btn" onclick="restartGame()">
                    <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
                </button>
            </div>
        </div>
        
        <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
        <div class="modal" id="results-modal">
            <div class="modal-content">
                <h2 style="color: var(--primary-dark);">Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰</h2>
                <div class="stars">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
                <div style="font-size: 24px; margin: 20px 0;">
                    <p>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©: <span id="final-score">0</span>/<span id="total-questions">0</span></p>
                    <p>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚: <span id="final-time">00:00</span></p>
                </div>
                <button class="action-btn next-btn" onclick="closeModal()" style="margin-top: 20px;">
                    <i class="fas fa-play"></i> Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
                </button>
            </div>
        </div>
        
        <!-- Ø£ØµÙˆØ§Øª Ø§Ù„Ù†Ø¬Ø§Ø­ -->
        <audio id="applause-sound" src="https://www.soundjay.com/human/sounds/applause-01.mp3" preload="auto"></audio>
        <audio id="success-chime" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3" preload="auto"></audio>
        
        <script>
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ÙˆØ³Ø¹Ø© Ù…Ù† Ø§Ù„Ø£Ù„Ù Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ§Ø¡
            const arabicLetters = [
                { letter: "Ø£", name: "Ø§Ù„Ø£Ù„Ù", words: ["Ø£Ø³Ø¯"], images: ["../../../images/lion.png"], sound: "Ø£", soundFile: "../../../../../sound/clap.mp3", examples: ["Ø£Ø³Ø¯", "Ø£Ø±Ù†Ø¨", "Ø£Ø®Ø·Ø¨ÙˆØ·"] },
                { letter: "Ø¨", name: "Ø§Ù„Ø¨Ø§Ø¡", words: ["Ø¨Ø§Ø¨"], images: ["../../../images/dor.png"], sound: "Ø¨", soundFile: "../../../../../sound/ba.mp3", examples: ["Ø¨Ø§Ø¨", "Ø¨Ø·Ø©", "Ø¨Ø±ØªÙ‚Ø§Ù„"] },
                { letter: "Øª", name: "Ø§Ù„ØªØ§Ø¡", words: ["ØªÙØ§Ø­Ø©"], images: ["../../../images/Apple.png"], sound: "Øª", soundFile: "../../../../../sound/tta.mp3", examples: ["ØªÙØ§Ø­Ø©", "ØªØ§Ø¬", "ØªÙ…Ø³Ø§Ø­"] },
                { letter: "Ø«", name: "Ø§Ù„Ø«Ø§Ø¡", words: ["Ø«Ø¹Ù„Ø¨"], images: ["../../../images/fox.png"], sound: "Ø«", soundFile: "../../../../../sound/tha.mp3", examples: ["Ø«Ø¹Ù„Ø¨", "Ø«ÙˆØ¨", "Ø«ÙˆÙ…"] },
                { letter: "Ø¬", name: "Ø§Ù„Ø¬ÙŠÙ…", words: ["Ø¬Ù…Ù„"], images: ["../../../images/Camial.png"], sound: "Ø¬", soundFile: "../../../../../sound/jeem.mp3", examples: ["Ø¬Ù…Ù„", "Ø¬Ø²Ø±", "Ø¬Ø¨Ù„"] },
                { letter: "Ø­", name: "Ø§Ù„Ø­Ø§Ø¡", words: ["Ø­Ù…Ø§Ù…Ø©"], images: ["../../../images/Hamama.png"], sound: "Ø­", soundFile: "../../../../../sound/haa.mp3", examples: ["Ø­Ù…Ø§Ù…Ø©", "Ø­Ø°Ø§Ø¡", "Ø­ÙˆØª"] },
                { letter: "Ø®", name: "Ø§Ù„Ø®Ø§Ø¡", words: ["Ø®Ø±ÙˆÙ"], images: ["../../../images/Sheep.png"], sound: "Ø®", soundFile: "../../../../../sound/kha.mp3", examples: ["Ø®Ø±ÙˆÙ", "Ø®Ø¨Ø²", "Ø®ÙŠØ§Ø±"] },
                { letter: "Ø¯", name: "Ø§Ù„Ø¯Ø§Ù„", words: ["Ø¯ÙŠÙƒ"], images: ["../../../images/dek.png"], sound: "Ø¯", soundFile: "../../../../../sound/dal.mp3", examples: ["Ø¯ÙŠÙƒ", "Ø¯ÙˆÙ„ÙÙŠÙ†", "Ø¯Ø¨"] },
                { letter: "Ø°", name: "Ø§Ù„Ø°Ø§Ù„", words: ["Ø°Ø¦Ø¨"], images: ["../../../images/walf.png"], sound: "Ø°", soundFile: "", examples: ["Ø°Ø¦Ø¨", "Ø°Ù‡Ø¨", "Ø°Ø±Ø§Ø¹"] },
                { letter: "Ø±", name: "Ø§Ù„Ø±Ø§Ø¡", words: ["Ø±ÙŠØ´Ø©"], images: ["../../../images/resha.png"], sound: "Ø±", soundFile: "", examples: ["Ø±ÙŠØ´Ø©", "Ø±Ù…Ø§Ù†", "Ø±Ø¬Ù„"] },
                { letter: "Ø²", name: "Ø§Ù„Ø²Ø§ÙŠ", words: ["Ø²Ù‡Ø±Ø©"], images: ["../../../images/flore.png"], sound: "Ø²", soundFile: "", examples: ["Ø²Ù‡Ø±Ø©", "Ø²Ø±Ø§ÙØ©", "Ø²ÙŠØªÙˆÙ†"] },
                { letter: "Ø³", name: "Ø§Ù„Ø³ÙŠÙ†", words: ["Ø³ÙŠØ§Ø±Ø©"], images: ["../../../images/car.png"], sound: "Ø³", soundFile: "", examples: ["Ø³ÙŠØ§Ø±Ø©", "Ø³Ù…ÙƒØ©", "Ø³Ø§Ø¹Ø©"] },
                { letter: "Ø´", name: "Ø§Ù„Ø´ÙŠÙ†", words: ["Ø´Ù…Ø³"], images: ["../../../images/Sun.png"], sound: "Ø´", soundFile: "", examples: ["Ø´Ù…Ø³", "Ø´Ø¬Ø±Ø©", "Ø´ÙˆÙƒØ©"] },
                { letter: "Øµ", name: "Ø§Ù„ØµØ§Ø¯", words: ["ØµÙ†Ø¯ÙˆÙ‚"], images: ["../../../images/box.png"], sound: "Øµ", soundFile: "", examples: ["ØµÙ†Ø¯ÙˆÙ‚", "ØµÙ‚Ø±", "ØµØ§Ø¨ÙˆÙ†"] },
                { letter: "Ø¶", name: "Ø§Ù„Ø¶Ø§Ø¯", words: ["Ø¶ÙØ¯Ø¹"], images: ["../../../images/defda.png"], sound: "Ø¶", soundFile: "", examples: ["Ø¶ÙØ¯Ø¹", "Ø¶Ø±Ø³", "Ø¶Ø¨Ø§Ø¨"] },
                { letter: "Ø·", name: "Ø§Ù„Ø·Ø§Ø¡", words: ["Ø·Ø§Ø¦Ø±Ø©"], images: ["../../../images/plane.png"], sound: "Ø·", soundFile: "", examples: ["Ø·Ø§Ø¦Ø±Ø©", "Ø·Ø¨Ù„", "Ø·Ø¨Ù‚"] },
                { letter: "Ø¸", name: "Ø§Ù„Ø¸Ø§Ø¡", words: ["Ø¸Ø¨ÙŠ"], images: ["../../../images/deer.png"], sound: "Ø¸", soundFile: "", examples: ["Ø¸Ø¨ÙŠ", "Ø¸ÙØ±", "Ø¸Ù„"] },
                { letter: "Ø¹", name: "Ø§Ù„Ø¹ÙŠÙ†", words: ["Ø¹ÙŠÙ†"], images: ["../../../images/eye.png"], sound: "Ø¹", soundFile: "", examples: ["Ø¹ÙŠÙ†", "Ø¹Ù†Ø¨", "Ø¹ØµÙÙˆØ±"] },
                { letter: "Øº", name: "Ø§Ù„ØºÙŠÙ†", words: ["ØºÙŠÙ…Ø©"], images: ["../../../images/gema.png"], sound: "Øº", soundFile: "", examples: ["ØºÙŠÙ…Ø©", "ØºØ²Ø§Ù„", "ØºØ±ÙØ©"] },
                { letter: "Ù", name: "Ø§Ù„ÙØ§Ø¡", words: ["ÙÙŠÙ„"], images: ["../../../images/feel.png"], sound: "Ù", soundFile: "", examples: ["ÙÙŠÙ„", "ÙØ³ØªØ§Ù†", "ÙØ±Ø§Ø´Ø©"] },
                { letter: "Ù‚", name: "Ø§Ù„Ù‚Ø§Ù", words: ["Ù‚Ù„Ù…"], images: ["../../../images/pincel.png"], sound: "Ù‚", soundFile: "", examples: ["Ù‚Ù„Ù…", "Ù‚Ù…Ø±", "Ù‚Ø±Ø¯"] },
                { letter: "Ùƒ", name: "Ø§Ù„ÙƒØ§Ù", words: ["ÙƒØªØ§Ø¨"], images: ["../../../images/book.png"], sound: "Ùƒ", soundFile: "", examples: ["ÙƒØªØ§Ø¨", "ÙƒØ±Ø©", "ÙƒÙˆØ¨"] },
                { letter: "Ù„", name: "Ø§Ù„Ù„Ø§Ù…", words: ["Ù„ÙŠÙ…ÙˆÙ†"], images: ["../../../images/lemon.png"], sound: "Ù„", soundFile: "", examples: ["Ù„ÙŠÙ…ÙˆÙ†", "Ù„Ø¹Ø¨Ø©", "Ù„ÙˆØ²"] },
                { letter: "Ù…", name: "Ø§Ù„Ù…ÙŠÙ…", words: ["Ù…ÙˆØ²"], images: ["../../../images/panan.png"], sound: "Ù…", soundFile: "", examples: ["Ù…ÙˆØ²", "Ù…ÙØªØ§Ø­", "Ù…Ø¯Ø±Ø³Ø©"] },
                { letter: "Ù†", name: "Ø§Ù„Ù†ÙˆÙ†", words: ["Ù†Ø­Ù„Ø©"], images: ["../../../images/nhla.png"], sound: "Ù†", soundFile: "", examples: ["Ù†Ø­Ù„Ø©", "Ù†Ù…Ø±", "Ù†Ø§ÙØ°Ø©"] },
                { letter: "Ù‡", name: "Ø§Ù„Ù‡Ø§Ø¡", words: ["Ù‡Ø¯Ù‡Ø¯"], images: ["../../../images/hodhod.png"], sound: "Ù‡", soundFile: "", examples: ["Ù‡Ø¯Ù‡Ø¯", "Ù‡Ù„Ø§Ù„", "Ù‡Ø¯ÙŠØ©"] },
                { letter: "Ùˆ", name: "Ø§Ù„ÙˆØ§Ùˆ", words: ["ÙˆØ±Ø¯Ø©"], images: ["../../../images/worda.png"], sound: "Ùˆ", soundFile: "", examples: ["ÙˆØ±Ø¯Ø©", "ÙˆØ´Ø§Ø­", "ÙˆØ³Ø§Ø¯Ø©"] },
                { letter: "ÙŠ", name: "Ø§Ù„ÙŠØ§Ø¡", words: ["ÙŠØ¯"], images: ["../../../images/hand.png"], sound: "ÙŠ", soundFile: "", examples: ["ÙŠØ¯", "ÙŠØ®Øª", "ÙŠØ±Ù‚Ø©"] }
            ];

            // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
            let currentIdx = 0;
            let gameActive = true;
            let correctCount = 0;
            let totalQuestions = 0;
            let currentMode = "recognition";
            let startTime = new Date();
            let timerInterval;
            let currentImageIndex = 0;

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
            function initGame() {
                currentIdx = 0;
                correctCount = 0;
                totalQuestions = 0;
                gameActive = true;
                startTime = new Date();
                currentImageIndex = 0;
                
                document.getElementById('correct-count').textContent = '0';
                document.getElementById('level').textContent = '1';
                updateTimer();
                clearInterval(timerInterval);
                timerInterval = setInterval(updateTimer, 1000);
                
                loadLetter(currentIdx);
                setupModeButtons();
                setupCanvas();
                setupImageNavigation();
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø±Ù Ø§Ù„Ø­Ø§Ù„ÙŠ
            function loadLetter(index) {
                if (index >= arabicLetters.length) {
                    showResults();
                    return;
                }
                
                gameActive = true;
                const data = arabicLetters[index];
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø±Ù
                document.getElementById('current-letter').textContent = data.letter;
                document.getElementById('letter-name').textContent = data.name;
                document.getElementById('letter-word').textContent = data.words[0];
                document.getElementById('target-letter').textContent = data.letter;
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©
                updateMainImage(data);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†Ù…Ø·
                updateExercise(data);
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                updateProgress();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ ØµÙˆØª Ø§Ù„ÙƒÙ„Ù…Ø©
                document.getElementById('word-sound-btn').onclick = () => playSound(data.sound, data.soundFile);
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            function updateMainImage(data) {
                const mainImage = document.getElementById('main-image');
                currentImageIndex = 0;
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ ØµÙˆØ± Ù…ØªØ§Ø­Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„Ù‰
                if (data.images && data.images.length > 0) {
                    mainImage.src = data.images[0];
                    mainImage.alt = data.examples[0] || data.letter;
                    document.getElementById('image-counter').textContent = `1 / ${data.images.length}`;
                } else {
                    // Ø¥Ø°Ø§ Ù„Ù… ØªØªÙˆÙØ± ØµÙˆØ±ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø£ÙŠÙ‚ÙˆÙ†Ø©
                    const iconName = data.letter === "Ø£" ? "apple" : 
                                    data.letter === "Ø¨" ? "book" : 
                                    data.letter === "Øª" ? "tree" : 
                                    data.letter === "Ø«" ? "fox" : 
                                    data.letter === "Ø¬" ? "camel" : 
                                    data.letter === "Ø­" ? "dove" : 
                                    data.letter === "Ø®" ? "sheep" : 
                                    data.letter === "Ø¯" ? "rooster" : 
                                    data.letter === "Ø°" ? "wolf" : 
                                    data.letter === "Ø±" ? "feather" : 
                                    data.letter === "Ø²" ? "flower" : 
                                    data.letter === "Ø³" ? "car" : 
                                    data.letter === "Ø´" ? "sun" : 
                                    data.letter === "Øµ" ? "box" : 
                                    data.letter === "Ø¶" ? "frog" : 
                                    data.letter === "Ø·" ? "plane" : 
                                    data.letter === "Ø¸" ? "deer" : 
                                    data.letter === "Ø¹" ? "eye" : 
                                    data.letter === "Øº" ? "cloud" : 
                                    data.letter === "Ù" ? "elephant" : 
                                    data.letter === "Ù‚" ? "pen" : 
                                    data.letter === "Ùƒ" ? "book" : 
                                    data.letter === "Ù„" ? "lemon" : 
                                    data.letter === "Ù…" ? "banana" : 
                                    data.letter === "Ù†" ? "bee" : 
                                    data.letter === "Ù‡" ? "hoopoe" : 
                                    data.letter === "Ùˆ" ? "rose" : 
                                    data.letter === "ÙŠ" ? "hand" : "book";
                    
                    // Ø±Ø§Ø¨Ø· Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø¬Ø§Ù†ÙŠØ©
                    mainImage.src = `https://cdn-icons-png.flaticon.com/512/3135/3135715.png`;
                    mainImage.alt = data.examples[0] || data.letter;
                    document.getElementById('image-counter').textContent = "1 / 1";
                }
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ±
                setupImageNavigationForLetter(data);
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ± Ù„Ù„Ø­Ø±Ù Ø§Ù„Ø­Ø§Ù„ÙŠ
            function setupImageNavigationForLetter(data) {
                const prevBtn = document.getElementById('prev-image-btn');
                const nextBtn = document.getElementById('next-image-btn');
                const mainImage = document.getElementById('main-image');
                const imageCounter = document.getElementById('image-counter');
                
                prevBtn.onclick = () => {
                    if (data.images.length <= 1) return;
                    currentImageIndex = (currentImageIndex - 1 + data.images.length) % data.images.length;
                    updateImage();
                };
                
                nextBtn.onclick = () => {
                    if (data.images.length <= 1) return;
                    currentImageIndex = (currentImageIndex + 1) % data.images.length;
                    updateImage();
                };
                
                function updateImage() {
                    mainImage.src = data.images[currentImageIndex];
                    mainImage.alt = data.examples[currentImageIndex] || data.letter;
                    imageCounter.textContent = `${currentImageIndex + 1} / ${data.images.length}`;
                }
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†Ù…Ø·
            function updateExercise(data) {
                const exerciseTitle = document.getElementById('exercise-title');
                
                switch(currentMode) {
                    case 'recognition':
                        exerciseTitle.textContent = 'Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±Ù';
                        generateRecognitionOptions(data.letter);
                        break;
                    case 'writing':
                        exerciseTitle.textContent = 'ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ø±Ù';
                        clearCanvas();
                        break;
                    case 'word':
                        exerciseTitle.textContent = 'Ø§Ù„Ø­Ø±Ù ÙÙŠ Ø§Ù„ÙƒÙ„Ù…Ø©';
                        generateWordOptions(data);
                        break;
                    case 'sound':
                        exerciseTitle.textContent = 'Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª';
                        generateSoundOptions(data.letter);
                        break;
                }
                
                // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø«Ù… Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ
                document.querySelectorAll('.exercise-content').forEach(exercise => {
                    exercise.classList.remove('active');
                });
                document.getElementById(`${currentMode}-exercise`).classList.add('active');
            }

            // ØªÙˆÙ„ÙŠØ¯ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±Ù
            function generateRecognitionOptions(correctLetter) {
                const container = document.getElementById('options-container');
                container.innerHTML = '';
                
                let options = [correctLetter];
                while(options.length < 6) {
                    let random = arabicLetters[Math.floor(Math.random() * arabicLetters.length)].letter;
                    if(!options.includes(random)) options.push(random);
                }
                
                options.sort(() => Math.random() - 0.5);
                
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = opt;
                    btn.onclick = () => checkAnswer(btn, opt, correctLetter);
                    container.appendChild(btn);
                });
            }

            // ØªÙˆÙ„ÙŠØ¯ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙƒÙ„Ù…Ø§Øª
            function generateWordOptions(data) {
                const container = document.getElementById('word-options-container');
                container.innerHTML = '';
                
                let options = [data.words[0]];
                while(options.length < 4) {
                    let randomLetter = arabicLetters[Math.floor(Math.random() * arabicLetters.length)];
                    let randomWord = randomLetter.words[Math.floor(Math.random() * randomLetter.words.length)];
                    if(!options.includes(randomWord)) options.push(randomWord);
                }
                
                options.sort(() => Math.random() - 0.5);
                
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.style.fontSize = '20px';
                    btn.textContent = opt;
                    btn.onclick = () => checkWordAnswer(btn, opt, data.words[0], data.letter);
                    container.appendChild(btn);
                });
            }

            // ØªÙˆÙ„ÙŠØ¯ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØµÙˆØª
            function generateSoundOptions(correctLetter) {
                const container = document.getElementById('sound-options-container');
                container.innerHTML = '';
                
                let options = [correctLetter];
                while(options.length < 6) {
                    let random = arabicLetters[Math.floor(Math.random() * arabicLetters.length)].letter;
                    if(!options.includes(random)) options.push(random);
                }
                
                options.sort(() => Math.random() - 0.5);
                
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = opt;
                    btn.onclick = () => checkAnswer(btn, opt, correctLetter);
                    container.appendChild(btn);
                });
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            function checkAnswer(btn, selected, correct) {
                if(!gameActive) return;
                gameActive = false;
                totalQuestions++;
                
                const feedback = document.getElementById('feedback');
                if(selected === correct) {
                    btn.classList.add('correct');
                    feedback.textContent = "ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©";
                    feedback.className = "feedback correct";
                    correctCount++;
                    document.getElementById('correct-count').textContent = correctCount;
                    playSuccessSound();
                } else {
                    btn.classList.add('wrong');
                    feedback.textContent = `Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! Ø§Ù„Ø­Ø±Ù Ø§Ù„ØµØ­ÙŠØ­ Ù‡Ùˆ ${correct}`;
                    feedback.className = "feedback wrong";
                    
                    // ØªØ³Ù„ÙŠØ· Ø§Ù„Ø¶ÙˆØ¡ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                    const allButtons = btn.parentElement.querySelectorAll('.option-btn');
                    allButtons.forEach(b => {
                        if(b.textContent === correct) {
                            b.classList.add('correct');
                        }
                    });
                    playErrorSound();
                }
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø©
            function checkWordAnswer(btn, selected, correctWord, correctLetter) {
                if(!gameActive) return;
                gameActive = false;
                totalQuestions++;
                
                const feedback = document.getElementById('feedback');
                if(selected === correctWord) {
                    btn.classList.add('correct');
                    feedback.innerHTML = `<i class="fas fa-check-circle"></i> Ù…Ù…ØªØ§Ø²! Ø§Ù„ÙƒÙ„Ù…Ø© "${correctWord}" ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù ${correctLetter}`;
                    feedback.className = "feedback correct";
                    correctCount++;
                    document.getElementById('correct-count').textContent = correctCount;
                    playSuccessSound();
                } else {
                    btn.classList.add('wrong');
                    feedback.innerHTML = `<i class="fas fa-times-circle"></i> Ù„ÙŠØ³ ØµØ­ÙŠØ­! Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ "${correctWord}"`;
                    feedback.className = "feedback wrong";
                    playErrorSound();
                }
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒØªØ§Ø¨Ø©
            function checkWriting() {
                if(!gameActive) return;
                gameActive = false;
                totalQuestions++;
                
                const feedback = document.getElementById('feedback');
                feedback.innerHTML = `<i class="fas fa-check-circle"></i> Ø¬ÙŠØ¯! Ø­Ø§ÙˆÙ„ Ø£Ù† ØªØ¬Ø¹Ù„ Ø§Ù„Ø­Ø±Ù Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ø§Ù‹`;
                feedback.className = "feedback correct";
                correctCount++;
                document.getElementById('correct-count').textContent = correctCount;
                playSuccessSound();
            }

            // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
            function playSound(sound, soundFile) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ù„Ù ØµÙˆØªÙŠ Ù…Ø±ÙÙˆØ¹ØŒ Ø´ØºÙ„Ù‡
                if(soundFile && soundFile.trim() !== "") {
                    try {
                        const audio = new Audio(soundFile);
                        audio.play().catch(e => {
                            console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ:", e);
                            // Ø¥Ø°Ø§ ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ù„ÙØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØµÙˆØª Ø§Ù„ØµÙ†Ø§Ø¹ÙŠ
                            playTTS(sound);
                        });
                    } catch (error) {
                        console.log("Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØª:", error);
                        playTTS(sound);
                    }
                } else {
                    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ù„ÙØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØµÙˆØª Ø§Ù„ØµÙ†Ø§Ø¹ÙŠ
                    playTTS(sound);
                }
            }

            // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„ØµÙ†Ø§Ø¹ÙŠ (Text-to-Speech)
            function playTTS(sound) {
                const utterance = new SpeechSynthesisUtterance(sound);
                utterance.lang = 'ar-SA';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }

            function playWordSound() {
                const currentLetter = arabicLetters[currentIdx];
                const word = currentLetter.words[0];
                
                // Ø­Ø§ÙˆÙ„ ØªØ´ØºÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØµÙˆØª Ø£ÙˆÙ„Ø§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                if(currentLetter.soundFile && currentLetter.soundFile.trim() !== "") {
                    try {
                        const audio = new Audio(currentLetter.soundFile);
                        audio.play().catch(e => {
                            // Ø¥Ø°Ø§ ÙØ´Ù„ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØµÙˆØª Ø§Ù„ØµÙ†Ø§Ø¹ÙŠ
                            playTTS(word);
                        });
                    } catch (error) {
                        playTTS(word);
                    }
                } else {
                    playTTS(word);
                }
            }

            // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù†Ø¬Ø§Ø­
            function playSuccessSound() {
                const chime = document.getElementById('success-chime');
                const applause = document.getElementById('applause-sound');
                
                try {
                    chime.currentTime = 0;
                    chime.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù†Ø¬Ø§Ø­:", e));
                    
                    setTimeout(() => {
                        applause.currentTime = 0;
                        applause.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØµÙÙŠÙ‚:", e));
                    }, 300);
                } catch (error) {
                    console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª:", error);
                }
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù‡ØªØ²Ø§Ø² Ø¨Ø³ÙŠØ· Ù„Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø§Ø­ØªÙØ§Ù„
                document.body.style.animation = "celebrate 0.5s ease";
                setTimeout(() => { document.body.style.animation = ""; }, 500);
            }

            // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø®Ø·Ø£
            function playErrorSound() {
                // Ù†ØºÙ…Ø© Ø®Ø·Ø£ Ø¨Ø³ÙŠØ·Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Web Audio API
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(150, audioContext.currentTime + 0.2);
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                } catch (error) {
                    console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø®Ø·Ø£:", error);
                }
            }

            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            function updateProgress() {
                const progress = ((currentIdx + 1) / arabicLetters.length) * 100;
                document.getElementById('progress-fill').style.width = progress + '%';
                document.getElementById('current-index').textContent = currentIdx + 1;
                document.getElementById('total-letters').textContent = arabicLetters.length;
                document.getElementById('progress-percent').textContent = Math.round(progress);
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ù‚Øª
            function updateTimer() {
                const now = new Date();
                const diff = Math.floor((now - startTime) / 1000);
                const minutes = Math.floor(diff / 60).toString().padStart(2, '0');
                const seconds = (diff % 60).toString().padStart(2, '0');
                document.getElementById('timer').textContent = `${minutes}:${seconds}`;
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ù…Ø·
            function setupModeButtons() {
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        currentMode = this.dataset.mode;
                        loadLetter(currentIdx);
                    });
                });
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø³Ù…
            function setupCanvas() {
                const canvas = document.getElementById('writing-canvas');
                const ctx = canvas.getContext('2d');
                let isDrawing = false;
                let lastX = 0;
                let lastY = 0;
                
                ctx.lineWidth = 5;
                ctx.lineCap = 'round';
                ctx.strokeStyle = '#1E88E5';
                
                canvas.addEventListener('mousedown', (e) => {
                    isDrawing = true;
                    [lastX, lastY] = [e.offsetX, e.offsetY];
                });
                
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', () => isDrawing = false);
                canvas.addEventListener('mouseout', () => isDrawing = false);
                
                // Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³
                canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    isDrawing = true;
                    const touch = e.touches[0];
                    const rect = canvas.getBoundingClientRect();
                    [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
                });
                
                canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    if (!isDrawing) return;
                    const touch = e.touches[0];
                    const rect = canvas.getBoundingClientRect();
                    draw({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
                });
                
                canvas.addEventListener('touchend', () => isDrawing = false);
                
                function draw(e) {
                    if (!isDrawing) return;
                    ctx.beginPath();
                    ctx.moveTo(lastX, lastY);
                    ctx.lineTo(e.offsetX, e.offsetY);
                    ctx.stroke();
                    [lastX, lastY] = [e.offsetX, e.offsetY];
                }
            }

            // Ù…Ø³Ø­ Ø§Ù„Ù„ÙˆØ­Ø©
            function clearCanvas() {
                const canvas = document.getElementById('writing-canvas');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                gameActive = true;
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ±
            function setupImageNavigation() {
                // Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„ØµÙˆØ±Ø©
                document.getElementById('next-letter-image').onclick = function() {
                    currentIdx++;
                    loadLetter(currentIdx);
                };
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            function showResults() {
                clearInterval(timerInterval);
                document.getElementById('final-score').textContent = correctCount;
                document.getElementById('total-questions').textContent = totalQuestions;
                document.getElementById('final-time').textContent = document.getElementById('timer').textContent;
                document.getElementById('results-modal').style.display = 'flex';
            }

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            function closeModal() {
                document.getElementById('results-modal').style.display = 'none';
                currentIdx = 0;
                loadLetter(currentIdx);
            }

            // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function restartGame() {
                if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©ØŸ')) {
                    initGame();
                }
            }

            // Ø²Ø± Ø§Ù„ØªÙ„Ù…ÙŠØ­
            document.getElementById('hint-btn').onclick = function() {
                const feedback = document.getElementById('feedback');
                const currentLetter = arabicLetters[currentIdx];
                
                switch(currentMode) {
                    case 'recognition':
                        feedback.innerHTML = `<i class="fas fa-lightbulb"></i> ØªÙ„Ù…ÙŠØ­: Ù‡Ø°Ø§ Ø­Ø±Ù ${currentLetter.name}`;
                        break;
                    case 'word':
                        feedback.innerHTML = `<i class="fas fa-lightbulb"></i> ØªÙ„Ù…ÙŠØ­: Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„Ù…Ø© ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù ${currentLetter.letter}`;
                        break;
                    case 'sound':
                        feedback.innerHTML = `<i class="fas fa-lightbulb"></i> ØªÙ„Ù…ÙŠØ­: Ø§Ø³ØªÙ…Ø¹ Ø¬ÙŠØ¯Ø§Ù‹ Ù„Ù„ØµÙˆØª`;
                        break;
                }
                
                feedback.className = "feedback";
                feedback.style.background = "#fff3cd";
                feedback.style.color = "#856404";
                feedback.style.border = "2px solid #ffeaa7";
            };

            // Ø²Ø± Ø§Ù„Ø­Ø±Ù Ø§Ù„ØªØ§Ù„ÙŠ
            document.getElementById('next-letter').onclick = function() {
                currentIdx++;
                loadLetter(currentIdx);
            };

            // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            window.onload = () => {
                initGame();
            };
        </script>
    </body>
</html>